import pandas as pd

def clean_excel(file_path, output_path):
    # Load Excel or CSV file
    if file_path.endswith('.csv'):
        df = pd.read_csv(file_path)
    else:
        df = pd.read_excel(file_path)

    # Remove duplicate rows
    df = df.drop_duplicates()

    # Fill missing values with empty string (or customize as needed)
    df = df.fillna('')

    # Example: Format date columns if any
    for col in df.columns:
        if 'date' in col.lower():
            try:
                df[col] = pd.to_datetime(df[col]).dt.strftime('%Y-%m-%d')
            except Exception:
                pass

    # Example: Strip whitespace from string columns
    for col in df.select_dtypes(include='object').columns:
        df[col] = df[col].str.strip()

    # Save cleaned data to new Excel file
    df.to_excel(output_path, index=False)
    print(f"Cleaned data saved to {output_path}")

if __name__ == "__main__":
    import sys
    if len(sys.argv) < 3:
        print("Usage: python clean_data.py <input_file> <output_file>")
    else:
        clean_excel(sys.argv[1], sys.argv[2])
